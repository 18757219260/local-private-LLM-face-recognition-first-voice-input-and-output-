2025-04-24 16:44:05,048 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:44:11,388 - ERROR - Task exception was never retrieved
future: <Task finished name='Task-1' coro=<main() done, defined at /home/wuye/vscode/chatbox/main/mian_stream.py:11> exception=KeyboardInterrupt()>
Traceback (most recent call last):
  File "/home/wuye/vscode/chatbox/main/mian_stream.py", line 83, in <module>
    asyncio.run(main())
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/site-packages/nest_asyncio.py", line 30, in run
    return loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/site-packages/nest_asyncio.py", line 92, in run_until_complete
    self._run_once()
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/site-packages/nest_asyncio.py", line 133, in _run_once
    handle._run()
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/asyncio/tasks.py", line 360, in __wakeup
    self.__step()
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/asyncio/tasks.py", line 277, in __step
    result = coro.send(None)
             ^^^^^^^^^^^^^^^
  File "/home/wuye/vscode/chatbox/main/mian_stream.py", line 27, in main
    question = asr.real_time_recognition()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wuye/vscode/chatbox/ASR/asr.py", line 51, in real_time_recognition
    data = self.stream.read(self.CHUNK, exception_on_overflow=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/wuye/miniconda3/envs/chatbox/lib/python3.11/site-packages/pyaudio.py", line 608, in read
    return pa.read_stream(self._stream, num_frames, exception_on_overflow)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
2025-04-24 16:47:10,185 - INFO - Use pytorch device_name: cuda
2025-04-24 16:47:10,185 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:47:11,198 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:47:11,209 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:47:11,212 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:47:17,590 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:48:44,551 - INFO - Use pytorch device_name: cuda
2025-04-24 16:48:44,551 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:48:46,307 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:48:46,328 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:48:46,331 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:48:52,971 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:48:53,015 - INFO - 模型问答耗时: 0.64秒
2025-04-24 16:49:04,108 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:49:04,495 - INFO - 模型问答耗时: 0.72秒
2025-04-24 16:49:17,884 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:49:18,440 - INFO - 模型问答耗时: 0.80秒
2025-04-24 16:49:33,472 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:49:33,554 - INFO - 模型问答耗时: 0.50秒
2025-04-24 16:49:41,795 - INFO - Use pytorch device_name: cuda
2025-04-24 16:49:41,795 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:49:47,137 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:49:47,148 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:49:47,151 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:50:12,653 - INFO - Use pytorch device_name: cuda
2025-04-24 16:50:12,653 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:50:17,996 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:50:18,006 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:50:18,009 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:50:25,022 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:50:26,030 - INFO - 模型问答耗时: 1.52秒
2025-04-24 16:50:38,898 - ERROR - 语音播放失败：[Errno 2] No such file or directory: 'temp_audio_124615993216016.mp3'
2025-04-24 16:50:45,903 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:50:46,540 - INFO - 模型问答耗时: 1.14秒
2025-04-24 16:51:03,091 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:53:29,498 - INFO - Use pytorch device_name: cuda
2025-04-24 16:53:29,498 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:53:34,859 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:53:34,870 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:53:34,873 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:54:34,375 - INFO - Use pytorch device_name: cuda
2025-04-24 16:54:34,375 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:54:36,877 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:54:36,888 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:54:36,890 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:54:43,734 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:54:43,817 - INFO - 模型问答耗时: 0.55秒
2025-04-24 16:54:59,410 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:54:59,493 - INFO - 模型问答耗时: 0.50秒
2025-04-24 16:55:13,042 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:55:13,126 - INFO - 模型问答耗时: 0.33秒
2025-04-24 16:55:31,152 - INFO - Use pytorch device_name: cuda
2025-04-24 16:55:31,152 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:55:32,644 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:55:32,655 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:55:32,658 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:55:39,256 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:55:39,308 - INFO - 模型问答耗时: 0.47秒
2025-04-24 16:55:53,171 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:55:54,040 - INFO - 模型问答耗时: 1.13秒
2025-04-24 16:56:23,042 - INFO - Use pytorch device_name: cuda
2025-04-24 16:56:23,042 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-24 16:56:25,191 - INFO - Loading faiss with AVX512 support.
2025-04-24 16:56:25,201 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-24 16:56:25,204 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-24 16:56:32,442 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-24 16:56:32,524 - INFO - 模型问答耗时: 0.48秒
2025-04-25 12:49:09,996 - INFO - Use pytorch device_name: cuda
2025-04-25 12:49:09,996 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 12:49:11,105 - INFO - Loading faiss with AVX512 support.
2025-04-25 12:49:11,125 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 12:49:11,128 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 12:49:11,130 - WARNING - Retry 1/3 loading vectorstore: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open ../faiss_index/index.faiss for reading: No such file or directory
2025-04-25 12:49:12,130 - WARNING - Retry 2/3 loading vectorstore: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open ../faiss_index/index.faiss for reading: No such file or directory
2025-04-25 12:49:13,130 - ERROR - Failed to load vectorstore after 3 attempts: Error in faiss::FileIOReader::FileIOReader(const char*) at /project/faiss/faiss/impl/io.cpp:67: Error: 'f' failed: could not open ../faiss_index/index.faiss for reading: No such file or directory
2025-04-25 12:49:26,656 - INFO - Use pytorch device_name: cuda
2025-04-25 12:49:26,656 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 12:49:27,601 - INFO - Loading faiss with AVX512 support.
2025-04-25 12:49:27,614 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 12:49:27,617 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 12:49:31,240 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 12:49:34,195 - INFO - Model streaming completed in 6.39 seconds
2025-04-25 12:52:24,567 - INFO - Use pytorch device_name: cuda
2025-04-25 12:52:24,567 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 12:52:25,663 - INFO - Loading faiss with AVX512 support.
2025-04-25 12:52:25,677 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 12:52:25,680 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 12:52:25,904 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 12:52:28,997 - INFO - 流式回答花费了 3.16 seconds
2025-04-25 12:58:58,245 - INFO - Use pytorch device_name: cuda
2025-04-25 12:58:58,245 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 12:58:59,232 - INFO - Loading faiss with AVX512 support.
2025-04-25 12:58:59,242 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 12:58:59,245 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 12:59:07,507 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 12:59:07,550 - INFO - 流式回答花费了 1.78 seconds
2025-04-25 12:59:14,088 - INFO - mpg123 进程开启
2025-04-25 12:59:25,606 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 12:59:25,650 - INFO - 流式回答花费了 0.23 seconds
2025-04-25 12:59:32,333 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 12:59:32,376 - INFO - 流式回答花费了 0.24 seconds
2025-04-25 12:59:39,280 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 12:59:39,323 - INFO - 流式回答花费了 0.28 seconds
2025-04-25 12:59:49,056 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 12:59:49,076 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 12:59:49,557 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:00:28,812 - INFO - Use pytorch device_name: cuda
2025-04-25 13:00:28,812 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 13:00:29,826 - INFO - Loading faiss with AVX512 support.
2025-04-25 13:00:29,839 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 13:00:29,843 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 13:00:36,143 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:00:36,188 - INFO - 流式回答花费了 0.35 seconds
2025-04-25 13:00:42,733 - INFO - mpg123 进程开启
2025-04-25 13:00:44,462 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:00:44,486 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:00:44,501 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:00:44,832 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:02:45,314 - INFO - Use pytorch device_name: cuda
2025-04-25 13:02:45,314 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 13:02:46,318 - INFO - Loading faiss with AVX512 support.
2025-04-25 13:02:46,329 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 13:02:46,332 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 13:02:52,896 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:02:52,938 - INFO - 流式回答花费了 0.32 seconds
2025-04-25 13:02:52,938 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:03:00,603 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:03:02,038 - INFO - mpg123 进程开启
2025-04-25 13:03:14,771 - INFO - 流式回答花费了 14.43 seconds
2025-04-25 13:03:14,771 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:03:23,010 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:03:23,053 - INFO - 流式回答花费了 0.25 seconds
2025-04-25 13:03:23,053 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:03:30,601 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:03:30,644 - INFO - 流式回答花费了 0.22 seconds
2025-04-25 13:03:30,644 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:03:40,242 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:03:40,296 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:03:40,780 - ERROR - 音频播放错误: [Errno 32] Broken pipe
2025-04-25 13:03:40,781 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:03:42,283 - ERROR - 清理资源时出错: [Errno 32] Broken pipe
2025-04-25 13:07:53,446 - INFO - Use pytorch device_name: cuda
2025-04-25 13:07:53,446 - INFO - Load pretrained SentenceTransformer: bge-base-zh-v1.5
2025-04-25 13:07:54,451 - INFO - Loading faiss with AVX512 support.
2025-04-25 13:07:54,462 - INFO - Successfully loaded faiss with AVX512 support.
2025-04-25 13:07:54,465 - INFO - Failed to load GPU Faiss: name 'GpuIndexIVFFlat' is not defined. Will not load constructor refs for GPU indexes.
2025-04-25 13:08:00,841 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:08:00,884 - INFO - 流式回答花费了 0.28 seconds
2025-04-25 13:08:00,885 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:08:08,476 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:08:08,520 - INFO - 流式回答花费了 0.27 seconds
2025-04-25 13:08:08,520 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:08:15,833 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:08:17,179 - INFO - 正在准备TTS音频: 甘薯不同品种耐贮性差异较大.紫薯比红薯耐贮藏,大叶红、烟薯2...
2025-04-25 13:08:19,438 - INFO - TTS音频准备完成，耗时: 2.26秒
2025-04-25 13:08:19,440 - INFO - mpg123 进程开启
2025-04-25 13:08:23,445 - INFO - TTS 处理总耗时: 6.27秒
2025-04-25 13:08:23,452 - INFO - 正在准备TTS音频: 、纺锤形、表皮薄、糖含量高的红薯不耐贮藏,北京553、红香蕉...
2025-04-25 13:08:25,746 - INFO - TTS音频准备完成，耗时: 2.29秒
2025-04-25 13:08:31,935 - INFO - TTS 处理总耗时: 8.48秒
2025-04-25 13:08:31,940 - INFO - 流式回答花费了 16.37 seconds
2025-04-25 13:08:31,940 - INFO - 正在准备TTS音频: 厚、糖含量低的红薯耐贮性稍好....
2025-04-25 13:08:34,054 - INFO - TTS音频准备完成，耗时: 2.11秒
2025-04-25 13:08:35,556 - INFO - TTS 处理总耗时: 3.62秒
2025-04-25 13:08:35,557 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:08:43,997 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:08:45,138 - INFO - 正在准备TTS音频: 我知道甘薯原产于美洲中部或南美洲西北部的热带地区,16世纪初...
2025-04-25 13:08:47,326 - INFO - TTS音频准备完成，耗时: 2.19秒
2025-04-25 13:08:51,330 - INFO - TTS 处理总耗时: 6.19秒
2025-04-25 13:08:51,331 - INFO - 流式回答花费了 7.69 seconds
2025-04-25 13:08:51,331 - INFO - 正在准备TTS音频: 、广东栽培....
2025-04-25 13:08:53,452 - INFO - TTS音频准备完成，耗时: 2.12秒
2025-04-25 13:08:54,053 - INFO - TTS 处理总耗时: 2.72秒
2025-04-25 13:08:54,053 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:09:02,204 - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-04-25 13:09:02,250 - INFO - 流式回答花费了 0.27 seconds
2025-04-25 13:09:02,250 - INFO - 等待 1.5 秒后再次开始监听...
2025-04-25 13:09:03,952 - INFO - mpg123 进程已关闭
